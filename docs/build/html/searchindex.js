Search.setIndex({"docnames": ["API/graph_generation", "API/index", "API/preprocess", "API/run_model", "examples/index", "examples/run_DOLPHIN", "index", "tutorials/index", "tutorials/step0_generate_exon_gtf_final", "tutorials/step1_1_preprocess_full_length", "tutorials/step1_2_preprocess_10X", "tutorials/step2_1_graph_generation", "tutorials/step2_2_exonGene_matrix_generation", "tutorials/step2_3_feature_matrix_generation", "tutorials/step2_4_adjacency_matrix_generation", "tutorials/step2_5_graph_data_generation", "tutorials/step3_run_DOLPHIN", "tutorials/step4_cell_aggregation", "tutorials/step5_alternative_splicing", "tutorials/step6_alternative_splicing_analysis", "tutorials/step7_1_MAST", "tutorials/step7_2_EDEG_analysis", "usage"], "filenames": ["API/graph_generation.rst", "API/index.rst", "API/preprocess.rst", "API/run_model.rst", "examples/index.rst", "examples/run_DOLPHIN.ipynb", "index.rst", "tutorials/index.rst", "tutorials/step0_generate_exon_gtf_final.ipynb", "tutorials/step1_1_preprocess_full_length.md", "tutorials/step1_2_preprocess_10X.md", "tutorials/step2_1_graph_generation.ipynb", "tutorials/step2_2_exonGene_matrix_generation.ipynb", "tutorials/step2_3_feature_matrix_generation.ipynb", "tutorials/step2_4_adjacency_matrix_generation.ipynb", "tutorials/step2_5_graph_data_generation.ipynb", "tutorials/step3_run_DOLPHIN.ipynb", "tutorials/step4_cell_aggregation.ipynb", "tutorials/step5_alternative_splicing.md", "tutorials/step6_alternative_splicing_analysis.ipynb", "tutorials/step7_1_MAST.ipynb", "tutorials/step7_2_EDEG_analysis.ipynb", "usage.md"], "titles": ["DOLPHIN Exon Graph Generation module", "API Documentations", "DOLPHIN Preprocess Module", "DOLPHIN Model module", "Examples", "Run DOLPHIN Model on Full-length Dataset", "Welcome to DOLPHIN\u2019s documentation!", "Tutorials", "Exon GTF Generation", "Preprocessing Full-Length Single-Cell RNA-Seq for Exon and Junction Read Counts", "Preprocessing 10X Single-Cell RNA-Seq for Exon and Junction Read Counts", "Generate Feature Matrix and Adjacency Matrix", "Generate Exon Gene h5ad and Select Highly Variable Genes", "Generate Feature Matrix", "Generate Adjacency Matrix", "Generate Graph Data for MODEl input", "Setup and Train the DOLPHIN Model", "Cell Aggregation", "Detect Alternative Splicing Events with Outrigger", "Alternative Splicing Analysis", "Run MAST to get Exon level p-value", "Exon-Level Differential Gene Analysis Using Feature Matrix", "Usage"], "terms": {"documentaion": 1, "dolphin": [1, 4, 7, 8, 11, 13, 14, 15, 17, 22], "packag": [1, 5, 6, 11, 13, 15, 22], "preprocess": [1, 6, 7, 8, 16, 22], "model": [1, 4, 6, 7, 17], "thi": [2, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22], "provid": [2, 3, 9, 10], "process": [2, 5, 8, 9, 10, 12, 17, 22], "gtf": [2, 6, 7, 10, 11, 12, 13, 14, 15, 18, 22], "file": [2, 5, 8, 12, 13, 14, 15, 18, 19, 20, 22], "gener": [2, 6, 7, 9, 10], "non": 2, "overlap": [2, 8], "exon": [2, 3, 6, 7, 11, 18, 22], "annot": [2, 12, 19], "i": [2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22], "recommend": [2, 3, 5, 22], "entri": [2, 8], "point": [2, 19], "user": [2, 5], "generate_exon_gtf": 2, "generate_nonoverlapping_exon": [2, 8], "input_gtf_path": [2, 8], "output_dir": 2, "batch_siz": 2, "10000": [2, 20], "sourc": [2, 3, 9, 10, 11], "end": 2, "pipelin": [2, 8, 9, 10], "an": [2, 3, 5, 8], "ensembl": [2, 8], "per": [2, 3, 16], "gene": [2, 6, 7, 8, 9, 10, 11, 16, 19], "perform": [2, 4, 10, 17, 21, 22], "follow": [2, 9, 10, 11, 22], "step": [2, 7, 8, 16, 19, 22], "1": [2, 8, 11, 12, 13, 14, 15, 19, 20, 21, 22], "load": [2, 5, 8, 15, 17], "filter": [2, 16, 17], "featur": [2, 3, 5, 6, 7], "from": [2, 3, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19, 21, 22], "2": [2, 5, 11, 14, 15, 18, 19, 20, 21, 22], "remov": [2, 8, 13, 15, 17, 19], "duplic": [2, 8, 19], "gene_id": [2, 12, 19], "start": [2, 5, 8, 9, 10, 13, 14, 15], "3": [2, 5, 8, 11, 12, 15, 17, 19, 21, 22], "each": [2, 8, 9, 10, 13, 14, 15, 16, 17, 18, 19], "merg": [2, 8, 12, 17, 19], "us": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 18, 19, 20, 22], "intervaltre": 2, "4": [2, 8, 9, 11, 12, 14, 19, 21, 22], "save": [2, 3, 5, 8, 15, 17, 19], "intermedi": 2, "result": [2, 3, 5, 12, 17], "batch": [2, 3, 8, 16, 17], "5": [2, 5, 14, 17, 19, 20], "combin": [2, 8, 13, 15, 21], "all": [2, 8, 11, 13, 15, 17], "final": [2, 17, 18, 19], "datafram": [2, 8, 12, 17, 19], "6": [2, 11, 17, 19], "option": [2, 3, 9, 15, 22], "check": [2, 12, 13, 14, 15, 22], "residu": 2, "7": [2, 5, 8, 9, 10, 17, 21], "pickl": [2, 5, 8], "format": [2, 12, 16, 19], "paramet": [2, 3, 21], "str": [2, 3, 8, 12, 13, 14, 15, 19, 21], "path": [2, 8, 11, 12, 13, 14, 15, 17, 19], "input": [2, 3, 6, 7, 8], "directori": [2, 3, 8, 9, 10], "output": [2, 3, 5, 8, 11, 12], "int": [2, 3, 17, 19], "number": [2, 3, 16, 19], "default": [2, 3, 5, 17], "return": [2, 3, 8, 12, 21], "gtf_all": 2, "pd": [2, 11, 12, 13, 14, 15, 17, 19, 21], "clean": 2, "tabl": [2, 11, 19], "overlap_issu": 2, "detect": [2, 6, 7], "post": 2, "ani": [2, 5], "The": [2, 3, 5, 8, 11, 21], "support": 2, "differ": [2, 21], "advanc": 2, "mai": [2, 12, 19, 22], "call": 2, "directli": [2, 8, 11], "prepare_exon_gtf": 2, "extract": [2, 8, 10], "level": [2, 3, 6, 7, 8, 10, 22], "uniqu": [2, 8, 19], "origin": [2, 9, 10, 17, 19], "dolphin_exon_gtf": [2, 8], "df_exon_nodup": 2, "same": 2, "type": [2, 3, 11, 15, 17, 21], "panda": [2, 8, 12, 17, 19, 21], "exon_uniq": 2, "singl": [2, 3, 6, 7, 8], "interv": 2, "tree": 2, "contain": [2, 4, 7, 11], "includ": [2, 3, 6, 11, 17, 19], "id": [2, 10, 19], "coordin": [2, 19], "whose": 2, "A": [2, 3, 8, 10], "given": 2, "where": [2, 3, 5, 9, 10, 12, 17], "ar": [2, 5, 8, 11], "updat": [2, 5, 11, 12, 13, 14, 15], "reindex": 2, "invalid": 2, "cannot": 2, "match": 2, "region": 2, "exclud": 2, "save_by_batch": 2, "save_num": 2, "serial": [2, 5], "pkl": [2, 8, 11, 13, 14, 15], "appli": [2, 19, 21], "data": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 18, 19], "up": [2, 11], "written": [2, 3], "log": [2, 10], "record": 2, "statu": [2, 8], "potenti": [2, 17], "error": [2, 19], "typic": 2, "10": [2, 5, 9, 11, 13, 15, 17, 19], "000": [2, 5], "store": [2, 9, 10, 11, 12], "write": [2, 12, 13, 14, 19, 20], "disk": 2, "doe": 2, "object": [2, 3, 5], "none": [2, 3, 12, 13, 14, 16, 17], "combine_saved_batch": 2, "folder": [2, 5, 11, 12, 16], "prefix": 2, "df_exon_gtf_": 2, "multipl": [2, 11], "concaten": [2, 13, 14, 17], "read": [2, 6, 7, 8, 11, 19], "specifi": [2, 3], "them": 2, "order": 2, "which": [2, 5, 9, 10, 17, 19], "parent": 2, "temp": 2, "filenam": 2, "identifi": [2, 10, 21], "row": [2, 8, 19, 20], "accord": 2, "sort": 2, "check_exon_overlap": 2, "gtf_df": [2, 8], "expected_gene_list": 2, "adjac": [2, 3, 6, 7, 16], "within": [2, 8], "whether": 2, "have": [2, 5, 11, 12, 19], "base": [2, 11, 12, 22], "posit": [2, 19], "compar": 2, "set": [2, 5, 8, 12, 19, 21], "expect": [2, 8], "list": [2, 11, 12, 16, 17, 19, 21], "miss": [2, 14, 19], "extra": 2, "least": 2, "column": [2, 11, 12, 17, 19, 21], "valid": [2, 18, 22], "were": 2, "empti": [2, 19], "save_gtf_output": 2, "base_nam": 2, "both": [2, 19], "two": [2, 19], "one": [2, 8, 9, 10, 11, 14, 17, 19], "standard": 2, "other": [2, 22], "python": [2, 6, 16, 22], "current": [2, 5, 16], "run_model": 3, "run_dolphin": [3, 5, 16], "data_typ": 3, "graph_in": 3, "fea_in": 3, "current_out_path": 3, "param": 3, "devic": 3, "cuda": 3, "0": [3, 5, 8, 9, 10, 11, 12, 13, 15, 17, 19, 20, 21], "seed_num": [3, 5, 16], "run": [3, 4, 6, 7, 8, 9, 10, 11, 22], "cell": [3, 6, 7, 11, 12, 15, 19, 21, 22], "rna": [3, 6, 7, 11], "seq": [3, 6, 7, 8, 11, 17], "obtain": [3, 11, 16], "latent": [3, 16], "embed": 3, "full": [3, 4, 6, 7, 10, 11, 12, 16], "length": [3, 4, 6, 7, 10, 11, 16], "For": [3, 9, 10, 11, 16, 22], "10x": [3, 6, 7, 9, 11, 16], "genom": [3, 16, 18], "graph": [3, 6, 7], "structur": 3, "precomput": 3, "anndata": [3, 12, 13, 14, 17, 19], "matrix": [3, 6, 7, 12, 19], "dolphin_z": [3, 5, 17, 19], "h5ad": [3, 5, 6, 7, 13, 14, 17, 19], "dict": [3, 12, 19, 21], "dictionari": [3, 16, 19], "hyperparamet": 3, "If": [3, 16], "depend": 3, "customiz": [3, 16], "gat_channel": [3, 16], "gat": [3, 16], "channel": 3, "head": [3, 16, 19], "nhead": [3, 16], "attent": [3, 16], "gat_dropout": [3, 16], "dropout": [3, 16], "rate": [3, 16], "layer": [3, 16], "list_gra_enc_hid": [3, 16], "encod": [3, 16], "mlp": 3, "hidden": 3, "size": [3, 16, 19], "gra_p_dropout": [3, 16], "z_dim": [3, 16], "dimension": [3, 16], "space": [3, 16], "list_fea_dec_hid": [3, 16], "decod": [3, 16], "list_adj_dec_hid": [3, 16], "lr": [3, 16], "learn": [3, 16], "mini": [3, 16], "epoch": [3, 5, 16], "train": [3, 5, 6, 7], "kl_beta": [3, 16], "kl": [3, 16], "diverg": [3, 16], "loss": [3, 5, 16], "weight": [3, 16, 21], "fea_lambda": [3, 16], "reconstruct": [3, 16], "adj_lambda": [3, 16], "gpu": 3, "acceler": 3, "random": [3, 17], "seed": 3, "reproduc": 3, "under": [3, 11], "section": [4, 7, 11, 12, 19, 21], "show": [4, 19, 21], "how": [4, 8, 12, 17, 19], "prepar": [4, 11], "analys": [4, 19], "outcom": 4, "perturb": 4, "visual": [4, 16], "reuslt": 4, "ipf": 4, "dataset": [4, 6, 10, 13, 14, 15, 17], "pleas": [4, 5, 9, 10, 11, 12, 13, 15, 22], "download": [4, 5, 8, 11, 22], "here": [4, 8, 9, 10, 11, 19, 22], "human": [5, 10, 11, 22], "pbmc": 5, "can": [5, 8, 9, 10, 11, 16, 22], "link": [5, 9, 10], "import": [5, 8, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22], "numpi": [5, 12, 16, 17, 19, 21], "np": [5, 12, 16, 17, 19, 21], "mnt": [5, 8, 9, 10, 11, 13, 15, 18], "md0": [5, 8, 11, 13, 15], "kailu": [5, 8, 9, 10, 11, 13, 15, 18], "anaconda3": [5, 11, 13, 15], "env": [5, 11, 13, 15, 22], "lib": [5, 11, 13, 15], "python3": [5, 11, 13, 15], "site": [5, 11, 13, 15], "tqdm": [5, 11, 12, 13, 14, 15, 19], "auto": [5, 11, 13, 15], "py": [5, 8, 11, 13, 15], "21": [5, 11, 13, 15, 21], "tqdmwarn": [5, 11, 13, 15], "iprogress": [5, 11, 13, 15], "found": [5, 8, 11, 13, 14, 15], "jupyt": [5, 11, 13, 15], "ipywidget": [5, 11, 13, 15], "see": [5, 8, 11, 13, 15], "http": [5, 8, 11, 13, 15, 22], "readthedoc": [5, 11, 13, 15], "io": [5, 11, 13, 15], "en": [5, 11, 13, 15], "stabl": [5, 8, 11, 13, 15], "user_instal": [5, 11, 13, 15], "html": [5, 8, 11, 13, 15], "autonotebook": [5, 11, 13, 15], "notebook_tqdm": [5, 11, 13, 15], "graph_data": [5, 16], "fsla_geometr": 5, "pt": [5, 15, 16], "feature_data": [5, 16], "fsla_featurecomphvg": 5, "adata": [5, 6, 7, 11, 12, 17], "output_path": [5, 8, 13, 14, 16], "11": 5, "md2": 5, "35": 5, "futurewarn": 5, "you": [5, 8, 10, 11, 12, 16, 22], "torch": [5, 15], "weights_onli": 5, "fals": [5, 12, 17, 19, 21], "valu": [5, 6, 7, 8, 12, 15], "modul": [5, 6], "implicitli": 5, "It": 5, "possibl": 5, "construct": [5, 15], "malici": 5, "execut": 5, "arbitrari": 5, "code": [5, 9], "dure": 5, "unpickl": 5, "github": [5, 22], "com": [5, 22], "pytorch": [5, 15], "blob": 5, "main": [5, 11, 17], "secur": 5, "md": [5, 11], "untrust": 5, "more": [5, 19, 21], "detail": [5, 11, 16], "In": [5, 9, 10, 17, 19, 21], "futur": 5, "releas": 5, "flip": 5, "true": [5, 11, 12, 17, 19, 20], "limit": 5, "function": [5, 12, 21], "could": 5, "longer": 5, "allow": [5, 8, 10], "via": 5, "mode": [5, 17, 22], "unless": 5, "thei": 5, "explicitli": 5, "allowlist": 5, "add_safe_glob": 5, "we": [5, 9, 10, 17, 19, 21, 22], "case": 5, "don": 5, "39": [5, 8, 9], "t": [5, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19], "control": 5, "open": [5, 12, 17, 22], "issu": 5, "relat": 5, "experiment": 5, "pg_celldata": 5, "in_path_gp": 5, "243664": 5, "7809": 5, "001": 5, "193576": 5, "1476": 5, "002": 5, "183068": 5, "1789": 5, "003": 5, "177823": 5, "9712": 5, "004": 5, "173529": 5, "6577": 5, "005": 5, "169590": 5, "5415": 5, "006": 5, "165866": 5, "2245": 5, "007": 5, "162289": 5, "8803": 5, "008": 5, "158826": 5, "5395": 5, "009": 5, "155455": 5, "0555": 5, "010": 5, "152165": 5, "2624": 5, "011": 5, "148957": 5, "0916": 5, "012": 5, "145820": 5, "2222": 5, "013": 5, "142753": 5, "7103": 5, "014": 5, "139754": 5, "0775": 5, "015": 5, "136820": 5, "1651": 5, "016": 5, "133950": 5, "8750": 5, "017": 5, "131141": 5, "6466": 5, "018": 5, "128395": 5, "5124": 5, "019": 5, "125708": 5, "3282": 5, "020": 5, "123077": 5, "6377": 5, "021": 5, "120506": 5, "1991": 5, "022": 5, "117991": 5, "0672": 5, "023": 5, "115529": 5, "5657": 5, "024": 5, "113122": 5, "8745": 5, "025": 5, "110771": 5, "5388": 5, "026": 5, "108471": 5, "2159": 5, "027": 5, "106221": 5, "5872": 5, "028": 5, "104021": 5, "6459": 5, "029": 5, "101874": 5, "6072": 5, "030": 5, "99772": 5, "7877": 5, "031": 5, "97719": 5, "8972": 5, "032": 5, "95714": 5, "1342": 5, "033": 5, "93753": 5, "6657": 5, "034": 5, "91837": 5, "6514": 5, "035": 5, "89966": 5, "3275": 5, "036": 5, "88136": 5, "9004": 5, "037": 5, "86349": 5, "4349": 5, "038": 5, "84604": 5, "2869": 5, "039": 5, "82898": 5, "2661": 5, "040": 5, "81232": 5, "5529": 5, "041": 5, "79605": 5, "0845": 5, "042": 5, "78015": 5, "9731": 5, "043": 5, "76462": 5, "7769": 5, "044": 5, "74945": 5, "8569": 5, "045": 5, "73464": 5, "5495": 5, "046": 5, "72015": 5, "8358": 5, "047": 5, "70602": 5, "3083": 5, "048": 5, "69220": 5, "8454": 5, "049": 5, "67872": 5, "1293": 5, "050": 5, "66554": 5, "6291": 5, "051": 5, "65266": 5, "7434": 5, "052": 5, "64008": 5, "4915": 5, "053": 5, "62780": 5, "6539": 5, "054": 5, "61580": 5, "7670": 5, "055": 5, "60408": 5, "2321": 5, "056": 5, "59262": 5, "7599": 5, "057": 5, "58144": 5, "0222": 5, "058": 5, "57051": 5, "6700": 5, "059": 5, "55983": 5, "1584": 5, "060": 5, "54939": 5, "4275": 5, "061": 5, "53920": 5, "3877": 5, "062": 5, "52923": 5, "7511": 5, "063": 5, "51949": 5, "5477": 5, "064": 5, "50997": 5, "6908": 5, "065": 5, "50068": 5, "0442": 5, "066": 5, "49159": 5, "4381": 5, "067": 5, "48271": 5, "3684": 5, "068": 5, "47402": 5, "9629": 5, "069": 5, "46554": 5, "7487": 5, "070": 5, "45725": 5, "5267": 5, "071": 5, "44914": 5, "9065": 5, "072": 5, "44122": 5, "8304": 5, "073": 5, "43349": 5, "3747": 5, "074": 5, "42591": 5, "3081": 5, "075": 5, "41850": 5, "8742": 5, "076": 5, "41126": 5, "0092": 5, "077": 5, "40417": 5, "8072": 5, "078": 5, "39724": 5, "1052": 5, "079": 5, "39047": 5, "3688": 5, "080": 5, "38384": 5, "6552": 5, "081": 5, "37737": 5, "4336": 5, "082": 5, "37102": 5, "2993": 5, "083": 5, "36481": 5, "8064": 5, "084": 5, "35875": 5, "8708": 5, "085": 5, "35281": 5, "7710": 5, "086": 5, "34702": 5, "8045": 5, "087": 5, "34134": 5, "3218": 5, "088": 5, "33579": 5, "0951": 5, "089": 5, "33036": 5, "9488": 5, "090": 5, "32503": 5, "2776": 5, "091": 5, "31981": 5, "9040": 5, "092": 5, "31471": 5, "2665": 5, "093": 5, "30972": 5, "7557": 5, "094": 5, "30483": 5, "2329": 5, "095": 5, "30004": 5, "9475": 5, "096": 5, "29536": 5, "7854": 5, "097": 5, "29078": 5, "6846": 5, "098": 5, "28629": 5, "6454": 5, "099": 5, "28190": 5, "1657": 5, "100": [5, 8, 13, 14, 15], "27761": 5, "9285": 5, "101": 5, "27342": 5, "4036": 5, "102": 5, "26927": 5, "8125": 5, "103": 5, "26523": 5, "4702": 5, "104": 5, "26126": 5, "8037": 5, "105": 5, "25739": 5, "5380": 5, "106": 5, "25359": 5, "4311": 5, "107": [5, 8, 9, 10, 12, 13, 14, 15, 18], "24988": 5, "5262": 5, "108": [5, 8], "24623": 5, "5034": 5, "109": 5, "24265": 5, "5814": 5, "110": 5, "23915": 5, "9552": 5, "111": [5, 8], "23571": 5, "1140": 5, "112": 5, "23236": 5, "3481": 5, "113": [5, 8], "22907": 5, "5403": 5, "114": 5, "22583": 5, "7561": 5, "115": 5, "22266": 5, "4170": 5, "116": 5, "21955": 5, "8116": 5, "117": 5, "21653": 5, "0890": 5, "118": 5, "21355": 5, "2765": 5, "119": 5, "21063": 5, "5031": 5, "120": 5, "20777": 5, "6584": 5, "121": 5, "20494": 5, "9528": 5, "122": 5, "20220": 5, "3241": 5, "123": 5, "19949": 5, "5874": 5, "124": 5, "19685": 5, "9230": 5, "125": 5, "19426": 5, "1909": 5, "126": 5, "19171": 5, "5292": 5, "127": 5, "18921": 5, "3619": 5, "128": 5, "18677": 5, "8733": 5, "129": 5, "18438": 5, "9748": 5, "130": 5, "18203": 5, "1131": 5, "131": 5, "17972": 5, "0053": 5, "132": 5, "17746": 5, "3087": 5, "133": 5, "17525": 5, "0124": 5, "134": 5, "17305": 5, "2934": 5, "135": 5, "17092": 5, "5511": 5, "136": 5, "16882": 5, "9240": 5, "137": 5, "16676": 5, "8641": 5, "138": 5, "16474": 5, "9341": 5, "139": 5, "16276": 5, "4748": 5, "140": 5, "16082": 5, "1129": 5, "141": 5, "15891": 5, "5012": 5, "142": 5, "15703": 5, "6361": 5, "143": 5, "15519": 5, "2370": 5, "144": 5, "15339": 5, "8857": 5, "145": 5, "15164": 5, "2684": 5, "146": 5, "14988": 5, "6335": 5, "147": 5, "14817": 5, "3861": 5, "148": 5, "14650": 5, "5068": 5, "149": 5, "14503": 5, "1708": 5, "150": 5, "14337": 5, "6277": 5, "151": 5, "14174": 5, "6211": 5, "152": 5, "14016": 5, "1644": 5, "153": 5, "13861": 5, "4158": 5, "154": 5, "13710": 5, "1173": 5, "155": 5, "13563": 5, "0723": 5, "156": 5, "13418": 5, "7632": 5, "157": 5, "13276": 5, "6898": 5, "158": 5, "13137": 5, "0246": 5, "159": 5, "13000": 5, "0937": 5, "160": 5, "12864": 5, "8395": 5, "161": 5, "12731": 5, "8535": 5, "162": 5, "12602": 5, "9918": 5, "163": 5, "12475": 5, "6962": 5, "164": 5, "12350": 5, "6650": 5, "165": 5, "12228": 5, "0789": 5, "166": 5, "12107": 5, "2485": 5, "167": 5, "11989": 5, "3485": 5, "168": 5, "11873": 5, "7139": 5, "169": 5, "11760": 5, "4716": 5, "170": 5, "11646": 5, "1021": 5, "171": 5, "11536": 5, "0823": 5, "172": 5, "11430": 5, "3383": 5, "173": 5, "11324": 5, "1356": 5, "174": 5, "11217": 5, "4272": 5, "175": 5, "11115": 5, "0607": 5, "176": 5, "11016": 5, "2439": 5, "177": 5, "10917": 5, "6308": 5, "178": 5, "10818": 5, "2257": 5, "179": 5, "10722": 5, "3327": 5, "180": 5, "10628": 5, "5501": 5, "181": 5, "10535": 5, "6122": 5, "182": 5, "10446": 5, "3344": 5, "183": 5, "10357": 5, "5469": 5, "184": 5, "10268": 5, "8737": 5, "185": 5, "10185": 5, "5327": 5, "186": 5, "10098": 5, "9644": 5, "187": 5, "10015": 5, "1413": 5, "188": 5, "9932": 5, "8176": 5, "189": 5, "9853": 5, "2093": 5, "190": 5, "9773": 5, "8692": 5, "191": 5, "9696": 5, "6192": 5, "192": 5, "9619": 5, "7378": 5, "193": 5, "9543": 5, "8816": 5, "194": 5, "9471": 5, "0236": 5, "195": 5, "9398": 5, "1895": 5, "196": 5, "9327": 5, "9709": 5, "197": 5, "9256": 5, "8217": 5, "198": 5, "9188": 5, "6437": 5, "199": 5, "9120": 5, "9490": 5, "19": [5, 16], "scanpi": [5, 12, 16, 17, 19], "sc": [5, 12, 16, 17, 19], "sklearn": [5, 16, 17, 19], "metric": [5, 16, 19], "adjusted_rand_scor": [5, 16, 19], "20": [5, 12, 16, 17, 21], "read_h5ad": [5, 12, 13, 14, 16, 17, 19], "pp": [5, 12, 16], "neighbor": [5, 16], "use_rep": [5, 16], "x_z": [5, 17], "tl": [5, 16], "umap": [5, 16], "leiden": [5, 16, 19], "random_st": 5, "print": [5, 12, 13, 14, 15, 16, 17, 21], "len": [5, 11, 12, 13, 14, 15, 16, 19, 21], "ob": [5, 11, 12, 16, 17, 19], "predict": 5, "celltyp": [5, 16, 19], "l1": 5, "8": [5, 21], "6339526635092507": 5, "22": [5, 12], "pl": [5, 16], "color": [5, 16], "wspace": [5, 16], "analysi": [6, 7, 10, 11, 12, 17], "cluster": [6, 11, 15], "differenti": [6, 7], "altern": [6, 7, 17], "splice": [6, 7, 17], "usag": 6, "instal": [6, 9, 10], "exampl": [6, 9], "tutori": [6, 11, 16, 22], "junction": [6, 7, 8, 11], "count": [6, 7, 8, 11, 17, 19], "select": [6, 7, 19], "highli": [6, 7], "variabl": [6, 7, 16, 19], "setup": [6, 7], "aggreg": [6, 7], "event": [6, 7], "outrigg": [6, 7], "psi": [6, 7, 18], "mast": [6, 7, 21], "p": [6, 7], "api": 6, "tool": [7, 22], "get": [7, 9, 10, 19], "guid": [8, 16], "explain": 8, "refer": [8, 11], "align": [8, 11, 17, 22], "scrna": 8, "goal": 8, "ensur": [8, 10, 11, 12], "do": [8, 17, 18], "anoth": 8, "pre": [8, 22], "first": [8, 10], "Then": 8, "script": 8, "o": [8, 9, 10, 11, 12, 13, 14, 15, 17, 19], "defin": [8, 12, 13, 14, 15, 17], "app": [8, 9], "ensembl_hg38": 8, "homo_sapien": [8, 9, 10, 12, 13, 14, 15, 18], "pars": 8, "3371244": 8, "total": [8, 13, 14, 15], "674296": 8, "remain": 8, "61860": [8, 19], "16": [8, 9, 10, 18], "37": 8, "lt": 8, "00": 8, "13": [8, 21], "46it": 8, "": [8, 17, 18, 19, 21], "done": [8, 17, 18], "finish": 8, "successfulli": 8, "354386": 8, "present": 8, "md1": 8, "gtfpy": 8, "settingwithcopywarn": 8, "try": 8, "copi": [8, 21], "slice": 8, "loc": 8, "row_index": 8, "col_index": 8, "instead": 8, "caveat": 8, "document": 8, "pydata": 8, "org": 8, "doc": 8, "user_guid": 8, "index": [8, 9, 10, 11, 12, 17, 18, 19, 21], "view": [8, 10, 17, 18], "versu": 8, "df": 8, "attribut": 8, "34": 8, "c": [8, 9, 20], "ingtf": 8, "astyp": [8, 19], "success": 8, "complet": [8, 12], "brief": [9, 10], "shown": [9, 10], "befor": [9, 10, 11], "make": [9, 10, 11], "sure": [9, 10, 11], "3a": [9, 10], "featurecount": [9, 10, 12], "trimmomat": 9, "command": [9, 10], "ensembl_mod_indx": [9, 10], "grch38": [9, 10, 11, 12, 13, 14, 15, 18], "dna_sm": [9, 10, 18], "primary_assembli": [9, 10, 18], "fa": [9, 10, 18], "runmod": [9, 10], "genomegener": [9, 10], "genomedir": [9, 10, 18], "star_exampl": [9, 10, 18], "genomefastafil": [9, 10], "sjdbgtffile": [9, 10], "runthreadn": [9, 10, 18], "studi": [9, 10, 12, 13, 14, 15, 19], "separ": [9, 11], "fastq": [9, 10, 17], "time": [9, 10, 11, 17], "below": [9, 16], "id_sampl": [9, 10, 18], "locat": 9, "timmomat": 9, "jar": 9, "java": 9, "se": [9, 10, 18, 19], "gz": 9, "illuminaclip": 9, "adapt": 9, "truseq3": 9, "30": 9, "lead": 9, "trail": 9, "slidingwindow": 9, "15": [9, 12, 21], "minlen": 9, "36": 9, "barcod": [9, 11], "name": [9, 10, 11, 13, 14, 15, 17, 19, 20, 21], "mkdir": [9, 10, 18], "03_exon_star": [9, 10, 12], "readfilesin": [9, 10, 18], "readfilescommand": [9, 10, 18], "gunzip": 9, "outsamtyp": [9, 10, 18], "bam": [9, 18], "sortedbycoordin": [9, 10], "outfilenameprefix": [9, 10, 18], "02_exon_std": [9, 10, 17], "ensembl_indx": [9, 10, 18], "std": [9, 10, 17], "modifi": [9, 10, 18], "exongen": [9, 10], "txt": [9, 10, 12, 17], "later": [9, 10, 11], "hvg": [9, 10, 16], "identif": [9, 10], "04_exon_gene_cnt": [9, 10, 13, 14, 15], "m": [9, 10], "sortedbycoord": [9, 10, 17], "out": [9, 10, 17, 18], "jcount": [9, 10], "05_exon_junct_cnt": [9, 10, 11], "f": [9, 10, 12, 13, 14, 15, 17, 18, 22], "j": [9, 10, 14], "cellrang": 10, "bamtool": 10, "colon": 10, "rectum": 10, "pdac": 10, "find": [10, 11], "ranger": [10, 22], "afterward": 10, "t10_std_cellrang": 10, "00_scexon": 10, "10_go_pdac": 10, "00_data_gener": [10, 11, 12], "00_raw": 10, "t10": 10, "sampl": [10, 12, 17, 19], "crr034505": 10, "transcriptom": 10, "refdata": 10, "gex": 10, "2020": 10, "chemistri": 10, "sc3pv2": 10, "keep": [10, 17, 19], "onli": [10, 11, 17, 19], "respect": 10, "downstream": [10, 12, 19], "bam_linux": 10, "possorted_genome_bam": 10, "t10_cb": 10, "csv": [10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21], "tag": 10, "cb": [10, 11, 12, 19], "z": [10, 16, 21], "debug": 10, "02_single_std_bam": 10, "padc_sub_t10": 10, "individu": 10, "correspond": [10, 12, 19], "specif": [10, 11, 12, 13, 14, 15], "u": 10, "analyz": [10, 16], "subsequ": 10, "tag_cb_": 10, "samtool": [10, 17, 18], "0x100": [10, 18], "readfilestyp": [10, 18], "sam": [10, 18], "instruct": 11, "step1_1_preprocess_full_length": 11, "step1_2_preprocess_10x": 11, "your": [11, 12, 13, 14, 15, 16], "readi": [11, 12], "also": 11, "adj_index": 11, "These": 11, "necessari": 11, "should": 11, "tab": [11, 17, 18], "mandatori": 11, "add": [11, 17, 18], "mani": 11, "need": [11, 12], "addit": 11, "retain": 11, "observ": [11, 12, 19], "t8_aaagcaagtcgcgaaa": 11, "stellat": 11, "t8_aaatgccagctggaac": 11, "macrophag": 11, "t8_aaatgccgtagctgcc": 11, "t8_aaatgcctccactggg": 11, "ductal": 11, "repres": [11, 16], "e": [11, 18, 22], "g": 11, "etc": 11, "ad": 11, "requir": [11, 13, 14, 15, 22], "get_gtf": 11, "undert": 11, "main_fold": [11, 12, 13, 14, 15, 19], "output_fold": 11, "06_graph_mtx": [11, 13, 14, 15], "makedir": [11, 12, 17], "join": [11, 12, 13, 14, 15, 17, 19], "exist_ok": [11, 12], "your_metadata": [11, 12, 13, 14, 15, 17, 18], "pd_gt": [11, 12, 17], "read_csv": [11, 12, 13, 14, 15, 17, 19, 21], "sep": [11, 12, 13, 14, 15, 17], "mr_cb_list": 11, "path_gtf": 11, "path_adj_index": 11, "adj_ind": 11, "implement": 11, "multiprocess": 11, "help": [11, 17, 19, 21], "speed": 11, "concurr": 11, "rang": [11, 13, 14, 15, 17, 19], "get_al": 11, "sy": 12, "exongene_fold": 12, "study_nam": [12, 13, 14, 15, 19], "output_directori": [12, 13, 14, 15, 19], "final_data": [12, 13, 14, 15, 19], "exongene_": 12, "output_hvg": 12, "exongene_hvg_": 12, "metadata": [12, 13, 14, 15, 17], "gtf_path": [12, 13, 14, 15], "shape": [12, 17, 19], "12": 12, "cnt_file": 12, "listdir": 12, "endswith": 12, "split": [12, 17, 19], "append": [12, 14, 17, 19], "exit": 12, "There": 12, "mismatch": 12, "between": [12, 21], "pd_count": 12, "enumer": [12, 13, 14, 15, 17, 19], "_cb": 12, "pd_cb": 12, "skiprow": 12, "geneid": [12, 19], "els": [12, 13, 14, 15, 17, 19, 21], "left_on": [12, 17, 19], "right_on": [12, 17, 19], "outer": [12, 17, 19], "set_index": [12, 19], "drop": [12, 17, 19], "pd_count_t": 12, "axi": [12, 17, 19], "right_index": [12, 19], "inplac": [12, 19], "slight": 12, "modif": 12, "def": [12, 21], "get_ens_dict": 12, "file_path": 12, "x": [12, 17, 19, 21], "startswith": 12, "gene_nam": [12, 19, 21], "chang": 12, "map": [12, 21], "lambda": [12, 19, 21], "gtf_dict": 12, "23": 12, "genenam": 12, "replac": [12, 17], "conver": [12, 19], "var": [12, 19], "iloc": [12, 17, 19], "dtype": [12, 19], "float32": [12, 19], "var_names_make_uniqu": 12, "filter_gen": 12, "min_cel": 12, "mt": 12, "var_nam": [12, 19], "group": 12, "mitochondri": 12, "calculate_qc_metr": 12, "qc_var": 12, "percent_top": 12, "log1p": 12, "normalize_tot": 12, "highly_variable_gen": 12, "n_top_gen": 12, "5000": 12, "raw": 12, "highly_vari": 12, "combine_fea": 13, "fea_comp": 13, "get_fea_hvg": 13, "df_label": [13, 14, 15], "total_sample_s": [13, 14, 15], "fea_run_num": 13, "graph_directori": [13, 14, 15], "exon_gene_featurecount_directori": [13, 14, 15], "gene_annot": [13, 14, 15], "gene_id_annot": [13, 14, 15], "gtf_pkl_path": [13, 14, 15], "gtf_jun_pkl_path": [13, 14, 15], "df_jun_gtf": [13, 14, 15], "pbar_fea": 13, "start_idx": [13, 14], "sample_num": [13, 14], "output_nam": [13, 14, 19], "total_number_fea_anndata": 13, "math": [13, 14, 15], "ceil": [13, 14, 15], "_idx": [13, 15, 17], "_fea_idx": 13, "_temp_ad": [13, 14], "feature_": 13, "_": [13, 14, 15, 21], "combine_anndata_fea": 13, "index_uniqu": [13, 14], "batch_kei": [13, 14], "temporari": [13, 14, 15], "file_pattern": [13, 14, 15], "files_to_remov": [13, 14, 15], "glob": [13, 14, 15], "exist": [13, 14, 15, 17, 19], "combine_adj": 14, "combine_adj_comp": 14, "adj_comp_re_part1": 14, "adj_comp_re_part2": 14, "adj_comp_re_part3": 14, "get_adj_hvg": 14, "step02_adj_mat_main_part2_main_2_parallel_run_x": 14, "adj_run_num": 14, "pbar_adj": 14, "total_number_adj_anndata": 14, "_anndata_adj_dict": 14, "_aa_all_names_lst": 14, "adjacency_": 14, "aa": 14, "_i": [14, 17], "_ad": 14, "item": 14, "combine_anndata_adj": 14, "_out_aa_nam": 14, "elif": [14, 17], "max": 14, "_anndata_aa_all_dict": 14, "_ca_nam": 14, "aa_al": 14, "combine_anndata": 14, "compress": 14, "version": 14, "pbar": 14, "_anndata_ca_dict": 14, "total_number_anndata": 14, "_ca_all_names_lst": 14, "adjacencycomp_": [14, 21], "ca": 14, "_out_ca_nam": 14, "_anndata_ca_all_dict": 14, "ca_al": 14, "get_graph_input": 15, "path_to_save_output_data": [15, 19], "gnn_run_num": 15, "inform": [15, 17], "celltypenam": 15, "assign": 15, "celltype_mapp": 15, "celltype1": 15, "celltype2": 15, "celltype3": 15, "celltype4": 15, "geometr": 15, "pbar_gnn": 15, "mapper": 15, "total_number_gnn_anndata": 15, "_gnn_idx": 15, "_temp_gnn": 15, "geometric_": 15, "combine_gnn": 15, "configur": 16, "architectur": 16, "your_graph_data": 16, "your_feature_matrix": 16, "explan": 16, "its": [16, 19], "own": 16, "descript": 16, "node": 16, "after": [16, 21], "neuron": 16, "fulli": 16, "connect": [16, 17], "optim": 16, "low": 16, "relationship": 16, "kneighbors_graph": 17, "shutil": 17, "algorithm": 17, "itself": 17, "n_neighbor": 17, "cell_conn_new": 17, "obsm": 17, "include_self": 17, "n_job": 17, "toarrai": 17, "cell_dist_new": 17, "distanc": 17, "neighborhood": 17, "701": 17, "main_nam": 17, "combine_nam": 17, "_cell_idx": 17, "main_sampl": 17, "nonzero": 17, "to_csv": [17, 21], "dolphin_aggregation_knn10": 17, "incorpor": 17, "confid": 17, "enhanc": 17, "signal": 17, "resolv": 17, "nois": 17, "take": 17, "account": 17, "pattern": 17, "nearbi": 17, "while": [17, 22], "echo": [17, 18], "get_single_bam_num": 17, "flagstat": 17, "line": 17, "readlin": 17, "samples_lin": 17, "n": [17, 18, 19], "14": 17, "count_lin": 17, "cnt": 17, "pd_cnt": 17, "num_seq": 17, "single_bam_count": 17, "sample_list": 17, "pd_aggr": 17, "pd_single_s": 17, "src_path": 17, "sj": [17, 18], "dist_path": 17, "dolphin_aggreg": [17, 18], "target": 17, "target_s": 17, "_neighbor": 17, "major": 17, "vote": 17, "frequent": [17, 19], "_temp_n": 17, "_df_junc": 17, "usecol": 17, "chr": [17, 18], "first_bas": 17, "last_bas": 17, "multi_map": 17, "df_merg": [17, 19], "occur": 17, "half": 17, "nont_na": 17, "isna": [17, 19], "sum": [17, 19, 21], "df_keep_junct": 17, "bed": [17, 18], "keep_junct": 17, "header": [17, 21], "_n": 17, "_n_seq": 17, "copyfil": 17, "renam": [17, 19, 21], "norm": [17, 21], "upsampl": 17, "some": [17, 19], "sequcen": 17, "togeth": 17, "concat": [17, 19], "integ": 17, "part": 17, "_cat_self_n": 17, "_add_seq_perct": 17, "reset": 17, "system": [17, 22], "b": 17, "current_nam": 17, "result_nam": 17, "downsampl": 17, "_keep_seq_perct": 17, "readsfil": 17, "h": 17, "awk": 17, "l": 17, "mj": 17, "final_bam": [17, 18], "rmtree": 17, "bin": [18, 19], "bash": 18, "tail": 18, "cut": 18, "d": [18, 19], "f1": 18, "combine_knn10_star": 18, "star": [18, 22], "unsort": 18, "scp": 18, "r": 18, "combine_knn10_sj": 18, "rm": 18, "cd": [18, 22], "begin": 18, "outrigger_output": [18, 19], "mxe": [18, 19], "sed": 18, "fasta": 18, "hg38": 18, "addchr": 18, "cover": 19, "conduct": 19, "manuscript": 19, "matplotlib": 19, "pyplot": 19, "plt": 19, "functool": 19, "reduc": 19, "scib": 19, "normalized_mutual_info_scor": 19, "outrigger_path": 19, "_psi_n10_exon": 19, "dolphin_lat": 19, "adata_lat": 19, "all_sampl": 19, "pd_psi_singl": 19, "outrigger_summari": 19, "sample_id": 19, "task": 19, "pca": 19, "convert": [19, 21], "event_id": 19, "sample_nam": 19, "_srr": 19, "_temp_df": 19, "df_merge_list": 19, "kei": 19, "left": 19, "right": 19, "df_recon": 19, "transpos": 19, "label": 19, "df_obs_org": 19, "left_index": 19, "AS": 19, "pd_mxe_ev": 19, "pd_se_ev": 19, "as_event_typ": 19, "pd_event": 19, "ignore_index": 19, "isoform1_gene_name_mod": 19, "isoform1_gene_nam": 19, "fillna": 19, "isoform1_gene_id": 19, "isoform2_gene_name_mod": 19, "isoform2_gene_nam": 19, "isoform2_gene_id": 19, "most": 19, "pd_event_isoform1": 19, "pd_event_isoform1_freq": 19, "groupbi": [19, 21], "dropna": [19, 21], "to_fram": 19, "count1": 19, "reset_index": [19, 21], "sort_valu": 19, "ascend": 19, "pd_event_isoform2": 19, "pd_event_isoform2_freq": 19, "count2": 19, "isoform": 19, "pd_event_gen": 19, "ha": [19, 22], "notna": 19, "than": 19, "dict_event_gen": 19, "zip": [19, 21], "sinc": 19, "2842": 19, "anndata_psi": 19, "_psi_n10_go": 19, "df_psi_raw": 19, "to_df": 19, "df_psi_raw_t": 19, "ge": 19, "plot": 19, "v": 19, "freq": 19, "patch": 19, "hist": 19, "edgecolor": 19, "white": 19, "800": 19, "25": 19, "bin_cent": 19, "diff": 19, "fr": 19, "height": 19, "xy": 19, "top": 19, "corner": 19, "histogram": 19, "bar": 19, "xytext": 19, "offset": 19, "abov": 19, "textcoord": 19, "center": 19, "va": 19, "bottom": 19, "fontsiz": 19, "legend": 19, "titl": 19, "xlabel": 19, "ylabel": 19, "df_psi_raw_t_filt": 19, "df_psi_raw_filt": 19, "calcul": [19, 21], "certain": 19, "wise": 19, "maintain": 19, "integr": 19, "mean": [19, 21], "sample_mean": 19, "skipna": 19, "ground": 19, "truth": 19, "categori": 19, "df_value_mean": 19, "as_index": 19, "round": 19, "dict_mean_clust": 19, "psi_mean_clust": 19, "fill": 19, "otherwis": 19, "caus": 19, "iter": 19, "df_psi_mod_mean_clust": 19, "back": [19, 21], "float": 19, "col": 19, "to_numer": 19, "coerc": 19, "df_obs_go_mean_clust": 19, "leiden_celltype1": 19, "adata_leiden": 19, "librari": 20, "dplyr": 20, "seurat": 20, "patchwork": 20, "seurat_obj": 20, "readrd": 20, "feature_paad_n3_t10_t8_t20_seurat_object_main": 20, "rd": 20, "ident": 20, "condit": [20, 21], "normalizedata": 20, "normal": 20, "method": 20, "lognorm": 20, "scale": 20, "factor": 20, "cluster_nam": 20, "sub_seurat": 20, "subset": [20, 21], "leiden_0_1": 20, "de_mast": 20, "findmark": 20, "cancer": 20, "test": [20, 22], "logfc": 20, "threshold": 20, "paste0": 20, "feature_mast_": 20, "_cluster_": [20, 21], "util": 21, "signific": 21, "express": 21, "enabl": 21, "granular": 21, "understand": 21, "regul": 21, "statsmodel": 21, "stat": 21, "multitest": 21, "smm": 21, "create_df_seurat": 21, "temp_nam": 21, "leiden_r": 21, "num": 21, "pd_temp": 21, "unnam": 21, "exon_nam": 21, "rfind": 21, "cancer_gene_nam": 21, "cancer_nam": 21, "p_val": 21, "_pval": 21, "p_val_adj": 21, "_pvals_adj": 21, "avg_log2fc": 21, "_logfoldchang": 21, "pct": 21, "_pct": 21, "05": 21, "ab": 21, "pd_combin": 21, "leiden_0_4_8": 21, "234": 21, "_abs_avg_log2fc": 21, "transform": 21, "scipi": 21, "stouffer_method": 21, "pval": 21, "unweight": 21, "arrai": 21, "combined_p_valu": 21, "combined_z": 21, "score": 21, "non_nan_pv": 21, "isnan": 21, "nan": 21, "z_score": 21, "isf": 21, "invers": 21, "surviv": 21, "equival": 21, "cdf": 21, "sqrt": 21, "sf": 21, "temp_stouffer_p": 21, "temp_p_valu": 21, "dict_temp_p_valu": 21, "_stouffer_pv": 21, "adjust": 21, "fisher": 21, "df_sub_temp": 21, "drop_dupl": 21, "adjusted_pv": 21, "multipletest": 21, "fdr_bh": 21, "adjusted_pvals_bonf": 21, "bonferroni": 21, "temp_adj_p": 21, "temp_adj_p_bonf": 21, "dict_p_adj": 21, "dict_p_adj_bonf": 21, "_stouffer_pval_adj": 21, "_stouffer_pval_adj_bonf": 21, "pd_combine_sub": 21, "mast_abs_avg_log2fc": 21, "mast_stouffer_pval_adj_bonf": 21, "742": 21, "adjacencycomp_leiden_0_4_8_cluster_2_mast_v2_": 21, "adjacencycomp_leiden_0_4_8_cluster_2_mast_v2_topp_": 21, "note": 22, "been": 22, "primarili": 22, "linux": 22, "platform": 22, "environ": 22, "best": 22, "compat": 22, "especi": 22, "memori": 22, "intens": 22, "clone": 22, "repositori": 22, "git": 22, "mcgilldinglab": 22, "creat": 22, "activ": 22, "conda": 22, "yaml": 22, "develop": 22, "pip": 22, "correctli": 22, "One": 22, "drive": 22}, "objects": {"DOLPHIN.model": [[3, 0, 0, "-", "run_model"]], "DOLPHIN.model.run_model": [[3, 1, 1, "", "run_DOLPHIN"]], "DOLPHIN.preprocess.generate_exon_gtf": [[2, 1, 1, "", "check_exon_overlap"], [2, 1, 1, "", "combine_saved_batches"], [2, 1, 1, "", "exon_uniq"], [2, 1, 1, "", "generate_nonoverlapping_exons"], [2, 1, 1, "", "prepare_exon_gtf"], [2, 1, 1, "", "save_by_batch"], [2, 1, 1, "", "save_gtf_outputs"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"dolphin": [0, 2, 3, 5, 6, 16], "exon": [0, 8, 9, 10, 12, 14, 20, 21], "graph": [0, 15, 16], "gener": [0, 8, 11, 12, 13, 14, 15, 19], "modul": [0, 1, 2, 3], "api": 1, "document": [1, 6], "preprocess": [2, 9, 10], "main": 2, "function": [2, 16], "helper": 2, "model": [3, 5, 15, 16], "exampl": [4, 22], "run": [5, 20], "full": [5, 9], "length": [5, 9], "dataset": [5, 16, 22], "welcom": 6, "": 6, "get": [6, 12, 17, 20], "start": 6, "tutori": 7, "gtf": [8, 9], "For": 8, "human": 8, "grch38": 8, "other": 8, "speci": 8, "singl": [9, 10, 16], "cell": [9, 10, 14, 16, 17], "rna": [9, 10, 16], "seq": [9, 10, 16], "junction": [9, 10, 14, 17], "read": [9, 10, 12, 17], "count": [9, 10, 12, 14], "step": [9, 10, 17], "1": [9, 10, 16, 17], "download": [9, 10], "requir": [9, 10], "tool": [9, 10], "2": [9, 10, 16, 17], "creat": [9, 10], "refer": [9, 10], "genom": [9, 10], "3": [9, 10, 16], "raw": [9, 10], "file": [9, 10, 11, 16, 17], "step4": 9, "trim": 9, "step5": 9, "star": [9, 10], "align": [9, 10], "modif": 9, "standard": 9, "6": [9, 10, 16], "10x": 10, "4": [10, 16], "obtain": 10, "barcod": 10, "bam": [10, 17], "5": [10, 16], "subset": 10, "retain": 10, "valid": 10, "split": 10, "step7": 10, "8": 10, "featur": [11, 13, 16, 21], "matrix": [11, 13, 14, 16, 21], "adjac": [11, 14], "metadata": 11, "format": 11, "note": 11, "process": [11, 16], "gene": [12, 13, 14, 21], "h5ad": [12, 16], "select": 12, "highli": [12, 13, 14, 16], "variabl": [12, 13, 14], "tabl": 12, "name": [12, 16], "filter": [13, 14], "hvg": [13, 14], "combin": 14, "all": 14, "set": [14, 16], "0": [14, 16], "both": 14, "ar": 14, "zero": 14, "remov": 14, "have": 14, "data": [15, 16], "input": [15, 16], "setup": 16, "train": 16, "load": 16, "hyperparamet": 16, "definit": 16, "paramet": 16, "data_typ": 16, "specifi": 16, "type": 16, "graph_in": 16, "The": 16, "fea_in": 16, "provid": 16, "an": 16, "anndata": 16, "object": 16, "adata": [16, 19], "current_out_path": 16, "output": 16, "directori": 16, "where": 16, "result": 16, "embed": 16, "x_z": 16, "save": 16, "dolphin_z": 16, "param": 16, "devic": 16, "default": 16, "cuda": 16, "gpu": 16, "recommend": 16, "7": 16, "seed_numset": 16, "random": 16, "seed": 16, "reproduc": 16, "cluster": [16, 19], "us": [16, 17, 21], "aggreg": 17, "find": 17, "neighbor": 17, "k": 17, "nearest": 17, "knn": 17, "ad": 17, "from": 17, "number": 17, "per": [17, 19], "librari": 17, "size": 17, "normal": 17, "detect": 18, "altern": [18, 19], "splice": [18, 19], "event": [18, 19], "outrigg": 18, "analysi": [19, 21], "psi": 19, "differenti": [19, 21], "averag": [19, 21], "valu": [19, 20, 21], "replac": 19, "nan": 19, "mast": 20, "level": [20, 21], "p": [20, 21], "stouffer": 21, "method": 21, "log2fc": 21, "usag": 22, "instal": 22}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"DOLPHIN Exon Graph Generation module": [[0, "dolphin-exon-graph-generation-module"]], "API Documentations": [[1, "api-documentations"]], "API Modules": [[1, null]], "DOLPHIN Preprocess Module": [[2, "dolphin-preprocess-module"]], "Main Function": [[2, "main-function"]], "Helper Functions": [[2, "helper-functions"]], "DOLPHIN Model module": [[3, "module-DOLPHIN.model.run_model"]], "Examples": [[4, "examples"]], "Run DOLPHIN Model on Full-length Dataset": [[5, "Run-DOLPHIN-Model-on-Full-length-Dataset"]], "Welcome to DOLPHIN\u2019s documentation!": [[6, "welcome-to-dolphin-s-documentation"]], "Getting started with DOLPHIN:": [[6, null]], "Tutorials": [[7, "tutorials"]], "Exon GTF Generation": [[8, "Exon-GTF-Generation"]], "For Human GRCh38": [[8, "For-Human-GRCh38"]], "For Other Species": [[8, "For-Other-Species"]], "Preprocessing Full-Length Single-Cell RNA-Seq for Exon and Junction Read Counts": [[9, "preprocessing-full-length-single-cell-rna-seq-for-exon-and-junction-read-counts"]], "Step 1: Download Required Tools": [[9, "step-1-download-required-tools"], [10, "step-1-download-required-tools"]], "Step 2: Create a Reference Genome": [[9, "step-2-create-a-reference-genome"], [10, "step-2-create-a-reference-genome"]], "Step 3: Download the Raw RNA-Seq Files": [[9, "step-3-download-the-raw-rna-seq-files"], [10, "step-3-download-the-raw-rna-seq-files"]], "Step4: Trim": [[9, "step4-trim"]], "Step5: STAR Alignment - align to modifed exon gtf file and standard reference genome": [[9, "step5-star-alignment-align-to-modifed-exon-gtf-file-and-standard-reference-genome"]], "Step 6: Count Exon Reads and Junction Reads": [[9, "step-6-count-exon-reads-and-junction-reads"]], "Preprocessing 10X Single-Cell RNA-Seq for Exon and Junction Read Counts": [[10, "preprocessing-10x-single-cell-rna-seq-for-exon-and-junction-read-counts"]], "Step 4: Obtain Cell Barcodes and BAM File": [[10, "step-4-obtain-cell-barcodes-and-bam-file"]], "Step 5: Subset BAM File to Retain Valid Cells with Cell Barcodes": [[10, "step-5-subset-bam-file-to-retain-valid-cells-with-cell-barcodes"]], "Step 6: Split into Single-Cell BAM Files": [[10, "step-6-split-into-single-cell-bam-files"]], "Step7: STAR Alignment": [[10, "step7-star-alignment"]], "Step 8: Count Exon Reads and Junction Reads": [[10, "step-8-count-exon-reads-and-junction-reads"]], "Generate Feature Matrix and Adjacency Matrix": [[11, "Generate-Feature-Matrix-and-Adjacency-Matrix"]], "Metadata File Format": [[11, "Metadata-File-Format"]], "Note on Processing": [[11, "Note-on-Processing"]], "Generate Exon Gene h5ad and Select Highly Variable Genes": [[12, "Generate-Exon-Gene-h5ad-and-Select-Highly-Variable-Genes"]], "Read exon Gene count table": [[12, "Read-exon-Gene-count-table"]], "get gene name": [[12, "get-gene-name"]], "Highly Variable Genes": [[12, "Highly-Variable-Genes"]], "Generate Feature Matrix": [[13, "Generate-Feature-Matrix"]], "Filter Feature Matrix with Highly Variable Genes (HVG)": [[13, "Filter-Feature-Matrix-with-Highly-Variable-Genes-(HVG)"]], "Generate Adjacency Matrix": [[14, "Generate-Adjacency-Matrix"]], "Combine all Adjacency Matrix": [[14, "Combine-all-Adjacency-Matrix"]], "Set Junction to 0 if Both Exon Counts are Zero": [[14, "Set-Junction-to-0-if-Both-Exon-Counts-are-Zero"]], "Remove Junctions if All Cells Have a Count of Zero": [[14, "Remove-Junctions-if-All-Cells-Have-a-Count-of-Zero"]], "Filter Adjacency Matrix with Highly Variable Genes (HVG)": [[14, "Filter-Adjacency-Matrix-with-Highly-Variable-Genes-(HVG)"]], "Generate Graph Data for MODEl input": [[15, "Generate-Graph-Data-for-MODEl-input"]], "Setup and Train the DOLPHIN Model": [[16, "Setup-and-Train-the-DOLPHIN-Model"]], "Load Processed Dataset": [[16, "Load-Processed-Dataset"]], "Set Hyperparameters and Train the Model": [[16, "Set-Hyperparameters-and-Train-the-Model"]], "Function Definition": [[16, "Function-Definition"]], "Parameters": [[16, "Parameters"]], "1. data_type Specifies the type of input single-cell RNA-seq data:": [[16, "1.-data_type-Specifies-the-type-of-input-single-cell-RNA-seq-data:"]], "2. graph_in The input graph dataset.": [[16, "2.-graph_in-The-input-graph-dataset."]], "3. fea_in The input feature matrix, provided as an AnnData object (adata).": [[16, "3.-fea_in-The-input-feature-matrix,-provided-as-an-AnnData-object-(adata)."]], "4. current_out_path Specifies the output directory where the resulting cell embeddings (X_z) will be saved. The output file will be named: DOLPHIN_Z.h5ad": [[16, "4.-current_out_path-Specifies-the-output-directory-where-the-resulting-cell-embeddings-(X_z)-will-be-saved.-The-output-file-will-be-named:-DOLPHIN_Z.h5ad"]], "5. params Model hyperparameters.": [[16, "5.-params-Model-hyperparameters."]], "6. device Specifies the device for training. Default: \"cuda:0\" for GPU training (highly recommended).": [[16, "6.-device-Specifies-the-device-for-training.-Default:-%22cuda:0%22-for-GPU-training-(highly-recommended)."]], "7. seed_numSets the random seed for reproducibility.": [[16, "7.-seed_numSets-the-random-seed-for-reproducibility."]], "Cell Embedding Cluster Using X_z": [[16, "Cell-Embedding-Cluster-Using-X_z"]], "Cell Aggregation": [[17, "Cell-Aggregation"]], "Step 1: Find Cell Neighbors Using K-Nearest Neighbors (KNN)": [[17, "Step-1:-Find-Cell-Neighbors-Using-K-Nearest-Neighbors-(KNN)"]], "Step 2: Cell Aggregation - Adding Junction Reads from Neighboring Cells": [[17, "Step-2:-Cell-Aggregation---Adding-Junction-Reads-from-Neighboring-Cells"]], "Get the Number of Reads per BAM File for Library Size Normalization": [[17, "Get-the-Number-of-Reads-per-BAM-File-for-Library-Size-Normalization"]], "Detect Alternative Splicing Events with Outrigger": [[18, "detect-alternative-splicing-events-with-outrigger"]], "Alternative Splicing Analysis": [[19, "Alternative-Splicing-Analysis"]], "Generate PSI adata": [[19, "Generate-PSI-adata"]], "Differential Alternative Splicing Events": [[19, "Differential-Alternative-Splicing-Events"]], "Average PSI Value Per Cluster to Replace NaN Values": [[19, "Average-PSI-Value-Per-Cluster-to-Replace-NaN-Values"]], "Run MAST to get Exon level p-value": [[20, "Run-MAST-to-get-Exon-level-p-value"]], "Exon-Level Differential Gene Analysis Using Feature Matrix": [[21, "Exon-Level-Differential-Gene-Analysis-Using-Feature-Matrix"]], "stouffer method and average p-value and average log2fc": [[21, "stouffer-method-and-average-p-value-and-average-log2fc"]], "Usage": [[22, "usage"]], "Installation": [[22, "installation"]], "Example Dataset": [[22, "example-dataset"]]}, "indexentries": {"check_exon_overlap() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.check_exon_overlap"]], "combine_saved_batches() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.combine_saved_batches"]], "exon_uniq() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.exon_uniq"]], "generate_nonoverlapping_exons() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.generate_nonoverlapping_exons"]], "prepare_exon_gtf() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.prepare_exon_gtf"]], "save_by_batch() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.save_by_batch"]], "save_gtf_outputs() (in module dolphin.preprocess.generate_exon_gtf)": [[2, "DOLPHIN.preprocess.generate_exon_gtf.save_gtf_outputs"]], "dolphin.model.run_model": [[3, "module-DOLPHIN.model.run_model"]], "module": [[3, "module-DOLPHIN.model.run_model"]], "run_dolphin() (in module dolphin.model.run_model)": [[3, "DOLPHIN.model.run_model.run_DOLPHIN"]]}})